<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title></title>
  <link rel="stylesheet" href="./../init.css" type="text/css" media="all" />
  <link rel="stylesheet" href="canvas.css" type="text/css" media="all" />
  <script src="lib.js" type="text/javascript" charset="utf-8"></script>
  <script src="canvas.js" type="text/javascript" charset="utf-8"></script>
  <style type="text/css" media="all">
    canvas {
      /* border-width: 1px; */
    }
  </style>
  <script type="text/javascript" charset="utf-8">
  </script>
  <script type="text/javascript" charset="utf-8">
    window.onload = () => {
      const [canvas, ctx] = getCanvas()
      adjustToViewport(canvas)

      const imageData = ctx.createImageData(canvas.width, canvas.height)

      const newData = imageData.data.map(
        (byte, i) => (i - 3) % 4 ? (i**(5))%255 : 255)

      const a = new Uint8ClampedArray(imageData.data.buffer)

      a.set(newData)

      ctx.putImageData(imageData, 0, 0)
    
  //canvas.toDataURL()

document.getElementsByTagName('a')[0].href=canvas.toDataURL()
  
      canvas.onclick =ev=>{
        //open(
        //,'save')
        //location.assign(
          //
        
        //)
        
      }
    }
  </script>
</head>

<body>
  <a download type="image/png">
  <canvas>
  </canvas>
  </a>
</body>

</html>